import{u as P,x as I,j as e,r as S,P as K,V as q,t as J,W as V,X,y as R}from"./index-DPJpM76q.js";import{S as Z}from"./index-Cu4eBb8-.js";import{a as ee,A as te,P as ae,b as w,H as O,U as $}from"./analitics-card-N-6qf1uQ.js";import{S as oe,R as re,M as se}from"./MetricsSelectionModal-CgpfzC4X.js";import{L as ne}from"./index-BCC9mltJ.js";import{m as ie}from"./proxy-B_r9RGkB.js";import{d as i}from"./dayjs.min-BgEnJCg9.js";import"./index-Bu88h86I.js";import{B as E}from"./button-lO7XdXyl.js";import{D as le}from"./index-dE2Nuwmx.js";import"./index-BOkOjOHF.js";import"./useSize-DND3t0aL.js";import"./Skeleton-C7BJEIB6.js";import"./index-D2xkBgQN.js";import"./CloseOutlined-Bs9BTzBM.js";import"./EllipsisOutlined-BD0YvPch.js";import"./index-WMb-X793.js";import"./Overflow-Cjb5NB4R.js";import"./useMergedState-CSfwPUM-.js";import"./Checkbox-D-9_4-G-.js";import"./context-C9R0sSvt.js";import"./x-DVMwgM0_.js";import"./index-BV9ecpN8.js";import"./PurePanel-DmuLXhi4.js";import"./roundedArrow-ySD6W0-A.js";import"./index--7a_W_9H.js";import"./collapse-BbEVqHco.js";import"./index-Da3FNLPO.js";import"./SearchOutlined-odOqp1gV.js";import"./index-CEm8Loj7.js";import"./useIcons-DvB46hj-.js";import"./CheckOutlined-C7HtwBlR.js";import"./DownOutlined-C_92woN3.js";function h({title:t,value:C,change:x,changeText:g,status:f}){const{t:v}=P(),{theme:j}=I(),o=j==="dark",m={backgroundColor:o?"#374151":"#ffffff",color:o?"#f3f4f6":"#111827",borderColor:o?"#4b5563":"#e5e7eb"},_={color:o?"#9ca3af":"#6b7280"},s=o?"shadow-lg shadow-gray-900/20":"shadow-sm hover:shadow-md";let l,u,r,p;switch(f){case"positive":l=te,u="text-green-500",r="bg-green-500",p=45;break;case"negative":l=ee,u="text-red-500",r="bg-red-500",p=-45;break;case"neutral":default:l=null,u=o?"text-gray-400":"text-gray-500",r=o?"bg-gray-600":"bg-gray-400",p=0;break}return e.jsxs(ie.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},transition:{duration:.3,ease:"easeOut"},className:"flex rounded-xl overflow-hidden max-h-[140px]",style:{boxShadow:o?"0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2)":"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)"},children:[e.jsx("div",{className:`w-1 ${r}`}),e.jsx("div",{className:"w-full transition-all duration-200",style:m,children:e.jsxs("div",{className:`p-4 rounded-r-xl border-r border-t border-b transition-shadow duration-200 ${s}`,style:{borderColor:m.borderColor,backgroundColor:m.backgroundColor},onMouseEnter:y=>{o||(y.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)")},onMouseLeave:y=>{o||(y.currentTarget.style.boxShadow="0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06)")},children:[e.jsx("div",{className:"mb-1 text-sm font-medium",style:_,children:v(t)}),e.jsx("div",{className:"text-3xl font-bold mb-2",style:{color:m.color},children:C}),e.jsxs("div",{className:`flex items-center ${u}`,children:[l&&e.jsx(l,{className:`w-5 h-5 mr-1 ${u}`,style:{transform:`rotate(${p}deg)`}}),e.jsxs("span",{className:"text-sm font-medium",children:[x!==0?`${x.toFixed(1)}% `:"",v(g)]})]})]})})]})}const{RangePicker:de}=le;function Ge(){var T,k,M,D;const{t}=P(),[C,x]=S.useState(!1),[g,f]=S.useState([i().startOf("month"),i().endOf("month")]),v="https://najotnur.avlo.app/",j=a=>a?a.format("YYYY-MM-DD"):"",{theme:o}=I(),m={start_date:j(g[0]),end_date:j(g[1])},[_,{data:s,isLoading:l,error:u}]=K(),{data:r,isLoading:p,error:y}=q(m);S.useEffect(()=>{_(m)},[g,_]);const Y=a=>{let n,d=i();switch(a){case"Last 7 Days":n=i().subtract(6,"days");break;case"Last 30 Days":n=i().subtract(29,"days");break;case"This Month":n=i().startOf("month"),d=i().endOf("month");break;case"Last Month":n=i().subtract(1,"month").startOf("month"),d=i().subtract(1,"month").endOf("month");break;default:return}f([n,d])},U=a=>{a&&a[0]&&a[1]?f([a[0],a[1]]):f([i().subtract(6,"days"),i()])},G=()=>{var a,n,d,b,c,B,L,z,N,A;return!s||!r?null:{date_range:{start:((n=(a=s.summary)==null?void 0:a.date_range)==null?void 0:n.start)||"",end:((b=(d=s.summary)==null?void 0:d.date_range)==null?void 0:b.end)||""},metrics:[{title:"Month-over-Month Growth",display_value:"0%",value:"0",change_text:"no change",change_type:"neutral"},{title:"Quarter-over-Quarter Growth",display_value:"0%",value:"0",change_text:"no change",change_type:"neutral"},{title:"Funnel Potential",display_value:"0%",value:"0",change_text:"no change",change_type:"neutral"},{title:"Lead to Sale",display_value:"0%",value:"0",change_text:"no change",change_type:"neutral"},{title:"Average Deal Size",display_value:"0%",value:"0",change_text:"no change",change_type:"neutral"},{title:"Average Sales Cycle",display_value:"0%",value:"0",change_text:"no change",change_type:"neutral"},{title:"New Customers",display_value:"0%",value:"0",change_text:"no change",change_type:"neutral"}],info_cards:[{title:"Number of minutes analyzed",display_value:`${Math.floor(r.total_duration/60)} min`,value:Math.floor(r.total_duration/60),description:"Total audio minutes analyzed during the selected period",icon:"ðŸŽ§",icon_class:"purple"},{title:"Number of audios analyzed",display_value:((c=r.anaylsed_data)==null?void 0:c.toString())||"0",value:r.anaylsed_data||0,description:"Total number of audios analyzed during the selected period",icon:"ðŸ‘¥",icon_class:"blue"},{title:"Total of audio minutes",display_value:`${Math.floor((((B=s.summary)==null?void 0:B.total_talk_time)||0)/60)} min`,value:Math.floor((((L=s.summary)==null?void 0:L.total_talk_time)||0)/60),description:"Total audio minutes analyzed during the selected period",icon:"ðŸŽ§",icon_class:"purple"},{title:"Total number of leads",display_value:((N=(z=s.summary)==null?void 0:z.total_leads)==null?void 0:N.toString())||"0",value:((A=s.summary)==null?void 0:A.total_leads)||0,description:"Total number of leads analyzed during the selected period",icon:"ðŸ‘¥",icon_class:"blue"}]}},F=async()=>{const a=G();if(!a){alert("Ma'lumot to'liq emas, serverga yuborilmadi");return}try{const n=await fetch(`${v}/api/stats/pdf/overall/`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${V.get(X)||""}`},body:JSON.stringify(a)});if(!n.ok)throw new Error(`Server error ${n.status}`);const d=await n.blob(),b=window.URL.createObjectURL(d),c=document.createElement("a");c.href=b,c.download=`overall-stats-${Date.now()}.pdf`,document.body.appendChild(c),c.click(),c.remove(),window.URL.revokeObjectURL(b)}catch(n){console.error("Serverga yuborishda xatolik:",n),alert("Serverga yuborishda xatolik yuz berdi")}},Q=()=>o==="dark"?{algorithm:R.darkAlgorithm,token:{colorPrimary:"#4338ca",borderRadius:8,colorBgContainer:"#374151",colorBgElevated:"#374151",colorBgLayout:"#1f2937",colorText:"#f3f4f6",colorTextSecondary:"#9ca3af",colorBorder:"#4b5563"}}:{algorithm:R.defaultAlgorithm,token:{colorPrimary:"#4338ca",borderRadius:8,colorBgContainer:"#ffffff",colorBgElevated:"#ffffff",colorBgLayout:"#f9fafb",colorText:"#111827",colorTextSecondary:"#6b7280",colorBorder:"#d1d5db"}},W={minHeight:"calc(100vh)",backgroundColor:o==="dark"?"#1f2937":"#f9fafb",color:o==="dark"?"#f3f4f6":"#111827"},H={color:o==="dark"?"#f3f4f6":"#111827"};return u||y?e.jsx("div",{style:{minHeight:"100vh",backgroundColor:o==="dark"?"#1f2937":"#f9fafb",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h2",{style:{fontSize:"1.25rem",fontWeight:600,color:"#dc2626",marginBottom:"0.5rem"},children:"Error Loading Dashboard"}),e.jsx("p",{style:{color:o==="dark"?"#9ca3af":"#6b7280"},children:"Please try refreshing the page"})]})}):e.jsxs(J,{theme:Q(),children:[e.jsxs("main",{style:{...W,padding:"20px 32px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"24px",gap:"16px"},className:"md:flex-row md:items-center",children:[e.jsx("h1",{style:{fontSize:"1.5rem",fontWeight:"bold",...H,margin:0},children:t("Business Overview")}),e.jsxs("div",{style:{display:"flex",gap:"12px",alignItems:"center"},children:[e.jsx(ne,{}),e.jsxs(E,{type:"primary",onClick:F,style:{display:"flex",alignItems:"center",backgroundColor:"#4338CA",borderColor:"#4338CA",height:"32px"},children:[e.jsx(ae,{style:{height:"20px",width:"20px",marginRight:"8px"}}),e.jsx("span",{children:t("Download PDF")})]}),e.jsx(oe,{onClick:()=>x(!0),icon:e.jsx(re,{style:{fontSize:"16px"}})})]})]}),e.jsx("div",{style:{marginBottom:"6px"},children:e.jsx(de,{style:{width:"100%",maxWidth:"320px",marginBottom:"2px"},format:"MMM D, YYYY",onChange:U,value:g,placeholder:["Start Date","End Date"]})}),e.jsx("div",{style:{marginBottom:"24px",display:"flex",flexWrap:"wrap",gap:"12px"},children:["Last 7 Days","Last 30 Days","This Month","Last Month"].map(a=>e.jsx(E,{style:{height:"28px"},onClick:()=>Y(a),children:t(a)},a))}),(l||p)&&e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"48px 0"},children:e.jsx("div",{style:{width:"32px",height:"32px",border:"2px solid transparent",borderTop:"2px solid #4338ca",borderRadius:"50%",animation:"spin 1s linear infinite"}})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"24px",marginBottom:"24px"},children:[e.jsx(h,{title:t("Month-over-Month Growth"),value:"0%",change:0,status:"neutral",changeText:t("no change")}),e.jsx(h,{title:t("Quarter-over-Quarter Growth"),value:"0%",change:0,status:"neutral",changeText:t("no change")}),e.jsx(h,{title:t("Funnel Potential"),value:"$0",change:0,status:"neutral",changeText:t("no change")}),e.jsx(h,{title:t("Lead to Sale"),value:"0%",change:0,status:"neutral",changeText:t("no change")})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"24px",marginBottom:"24px"},children:[e.jsx(h,{title:t("Average Deal Size"),value:"$0",change:0,status:"neutral",changeText:t("no change")}),e.jsx(h,{title:t("Average Sales Cycle"),value:"0",change:0,status:"neutral",changeText:t("no change")}),e.jsx(h,{title:t("New Customers"),value:"0",change:0,status:"neutral",changeText:t("no change")})]}),!l&&!p&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(600px, 1fr))",gap:"24px",marginBottom:"24px"},children:[e.jsx(w,{icon:e.jsx(O,{height:36,width:36,style:{color:"#4338ca"}}),title:t("Number of minutes analyzed"),value:r?`${Math.floor((r==null?void 0:r.total_duration)/60)} min`:"0 min",description:t("Total audio minutes analyzed during the selected period"),borderColor:"border-indigo-500"}),e.jsx(w,{icon:e.jsx($,{height:36,width:36,style:{color:"#4338ca"}}),title:t("Number of audios analyzed"),value:((T=r==null?void 0:r.anaylsed_data)==null?void 0:T.toString())||"0",description:t("Total number of audios analyzed during the selected period"),borderColor:"border-indigo-500"}),e.jsx(w,{icon:e.jsx(O,{height:36,width:36,style:{color:"#4338ca"}}),title:t("Total of audio minutes"),value:typeof((k=s==null?void 0:s.summary)==null?void 0:k.total_talk_time)=="number"?`${Math.floor(s.summary.total_talk_time/60)} min`:"0 min",description:t("Total audio minutes analyzed during the selected period"),borderColor:"border-indigo-500"}),e.jsx(w,{icon:e.jsx($,{height:36,width:36,style:{color:"#4338ca"}}),title:t("Total number of leads"),value:((D=(M=s==null?void 0:s.summary)==null?void 0:M.total_leads)==null?void 0:D.toString())||"0",description:t("Total number of leads analyzed during the selected period"),borderColor:"border-indigo-500"})]}),e.jsx("div",{style:{marginTop:"auto",marginBottom:"16px"},children:e.jsx(Z,{context:"sdr"})})]}),e.jsx(se,{isOpen:C,onClose:()=>x(!1)})]})}export{Ge as default};
