import{Y as mt,r as h,x as ht,u as xt,ap as gt,ag as f,aq as d,ar as p,j as t,t as yt,y as Y}from"./index-DPJpM76q.js";import{L as bt}from"./index-BCC9mltJ.js";import{F as kt}from"./Table-DBR-Ln6h.js";import{m as w}from"./proxy-B_r9RGkB.js";import{E as St}from"./eye-CZwNeZVC.js";import{M as wt}from"./index-BvICwX4g.js";import"./index-Bu88h86I.js";import"./index-BV9ecpN8.js";import"./PurePanel-DmuLXhi4.js";import"./useSize-DND3t0aL.js";import"./index-WMb-X793.js";import"./useMergedState-CSfwPUM-.js";import"./EllipsisOutlined-BD0YvPch.js";import"./Overflow-Cjb5NB4R.js";import"./roundedArrow-ySD6W0-A.js";import"./context-C9R0sSvt.js";import"./button-lO7XdXyl.js";import"./index--7a_W_9H.js";import"./collapse-BbEVqHco.js";import"./index-Da3FNLPO.js";import"./styleChecker-CQu6Uniq.js";import"./SearchOutlined-odOqp1gV.js";import"./useBreakpoint-CymGIX01.js";import"./index-CEm8Loj7.js";import"./useIcons-DvB46hj-.js";import"./CheckOutlined-C7HtwBlR.js";import"./CloseOutlined-Bs9BTzBM.js";import"./DownOutlined-C_92woN3.js";import"./responsiveObserver-C7S2khFd.js";import"./index-DxEnr912.js";import"./Checkbox-D-9_4-G-.js";import"./Pagination-ZTiU5Rel.js";import"./index-ZaNRnAce.js";import"./TextArea-DlB-ovtE.js";import"./ExclamationCircleFilled-C-Rs3AQT.js";import"./InfoCircleFilled-CHTLRjTa.js";import"./context-CMJBuI1T.js";import"./Skeleton-C7BJEIB6.js";const le=()=>{const[j,J]=mt(),X=Number(j.get("page"))||1,[v,C]=h.useState(X),[g,P]=h.useState(null),[Z,B]=h.useState(!1),{theme:e}=ht(),{t:s}=xt();h.useEffect(()=>{const r=Number(j.get("page"))||1;r!==v&&C(r)},[j]);const{data:x,isLoading:tt,isFetching:et,error:rt}=gt({page:v,limit:50}),ot=r=>{C(r);const o=new URLSearchParams(j);o.set("page",String(r)),J(o)},y=(x==null?void 0:x.result)||[],at=(x==null?void 0:x.total)||0,i=h.useMemo(()=>{const r=y.map(o=>o.responsible_user_id).filter(o=>o!=null);return[...new Set(r)]},[y]),T=f(i[0]?{operatorId:i[0]}:d),A=f(i[1]?{operatorId:i[1]}:d),E=f(i[2]?{operatorId:i[2]}:d),L=f(i[3]?{operatorId:i[3]}:d),M=f(i[4]?{operatorId:i[4]}:d),$=f(i[5]?{operatorId:i[5]}:d),_=f(i[6]?{operatorId:i[6]}:d),F=f(i[7]?{operatorId:i[7]}:d),N=f(i[8]?{operatorId:i[8]}:d),W=f(i[9]?{operatorId:i[9]}:d),st=h.useMemo(()=>{const r=new Map;return[T,A,E,L,M,$,_,F,N,W].forEach((a,c)=>{var m,l;const u=i[c];u&&((l=(m=a.data)==null?void 0:m.data)!=null&&l[0])&&r.set(u,a.data.data[0])}),r},[i,T,A,E,L,M,$,_,F,N,W]),n=h.useMemo(()=>{const r=y.map(o=>o.status_id).filter(o=>o!=null);return[...new Set(r)]},[y]),O=p(n[0]?{statusId:n[0]}:d),z=p(n[1]?{statusId:n[1]}:d),R=p(n[2]?{statusId:n[2]}:d),U=p(n[3]?{statusId:n[3]}:d),G=p(n[4]?{statusId:n[4]}:d),H=p(n[5]?{statusId:n[5]}:d),q=p(n[6]?{statusId:n[6]}:d),Q=p(n[7]?{statusId:n[7]}:d),V=p(n[8]?{statusId:n[8]}:d),D=p(n[9]?{statusId:n[9]}:d),it=h.useMemo(()=>{const r=new Map;return[O,z,R,U,G,H,q,Q,V,D].forEach((a,c)=>{var m,l;const u=n[c];u&&((l=(m=a.data)==null?void 0:m.data)!=null&&l[0])&&r.set(u,a.data.data[0])}),r},[n,O,z,R,U,G,H,q,Q,V,D]),nt=()=>e==="dark"?{algorithm:Y.darkAlgorithm,token:{colorPrimary:"#4338ca",borderRadius:8,colorBgContainer:"#374151",colorBgElevated:"#374151",colorBgLayout:"#1f2937",colorText:"#f3f4f6",colorTextSecondary:"#9ca3af",colorBorder:"#4b5563",colorBorderSecondary:"#6b7280",colorFillSecondary:"#4b5563",colorFillTertiary:"#374151",colorFillQuaternary:"#374151",controlItemBgActive:"#4338ca",controlItemBgHover:"#4b5563"}}:{algorithm:Y.defaultAlgorithm,token:{colorPrimary:"#4338ca",borderRadius:8,colorBgContainer:"#ffffff",colorBgElevated:"#ffffff",colorBgLayout:"#f9fafb",colorText:"#111827",colorTextSecondary:"#6b7280",colorBorder:"#d1d5db",colorBorderSecondary:"#e5e7eb",colorFillSecondary:"#f3f4f6",colorFillTertiary:"#f9fafb",colorFillQuaternary:"#ffffff",controlItemBgActive:"#e0e7ff",controlItemBgHover:"#f3f4f6"}},K={padding:"32px",backgroundColor:e==="dark"?"#1f2937":"#f9fafb",minHeight:"100vh",color:e==="dark"?"#f3f4f6":"#111827"},dt={display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"24px"},lt={fontSize:"28px",fontWeight:"600",color:e==="dark"?"#f3f4f6":"#1f2937",margin:0},ct={border:`1px solid ${e==="dark"?"#374151":"#e5e7eb"}`,borderRadius:"12px",overflow:"hidden",backgroundColor:e==="dark"?"#374151":"#ffffff",boxShadow:e==="dark"?"0 4px 6px -1px rgba(0, 0, 0, 0.3)":"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},ft={display:"flex",alignItems:"center",justifyContent:"center",padding:"8px",borderRadius:"6px",border:"none",backgroundColor:e==="dark"?"#065f46":"#ecfdf5",cursor:"pointer",transition:"all 0.2s ease-in-out"},pt={width:"100%",borderCollapse:"collapse",backgroundColor:e==="dark"?"#374151":"#ffffff",border:`1px solid ${e==="dark"?"#4b5563":"#e5e7eb"}`,borderRadius:"8px",overflow:"hidden"},b={padding:"12px 16px",width:"40%",fontWeight:"600",textAlign:"left",borderBottom:`1px solid ${e==="dark"?"#4b5563":"#e5e7eb"}`,borderRight:`1px solid ${e==="dark"?"#4b5563":"#e5e7eb"}`,backgroundColor:e==="dark"?"#4b5563":"#f9fafb",color:e==="dark"?"#f3f4f6":"#374151"},k={padding:"12px 16px",borderBottom:`1px solid ${e==="dark"?"#4b5563":"#e5e7eb"}`,color:e==="dark"?"#d1d5db":"#6b7280",backgroundColor:e==="dark"?"#374151":"#ffffff"},ut=[{title:"No",dataIndex:"id",render:(r,o,a)=>(v-1)*50+a+1,width:60},{title:s("Title"),dataIndex:"name",render:r=>t.jsx("div",{style:{maxWidth:"180px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e==="dark"?"#f3f4f6":"#111827"},title:r||s("No title"),children:r||s("No title")})},{title:s("Created at"),dataIndex:"created_at",render:r=>{if(!r)return"";try{const o=new Date(typeof r=="number"?r*1e3:r),a=o.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),c=o.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1});return t.jsxs("div",{style:{maxWidth:"130px",color:e==="dark"?"#d1d5db":"#6b7280"},title:`${a} ${c}`,children:[a.replace(/\//g,".")," ",t.jsx("br",{})," ",c]})}catch{return t.jsx("div",{style:{maxWidth:"130px",color:e==="dark"?"#ef4444":"#dc2626"},children:"Invalid date"})}}},{title:s("Assigned to"),dataIndex:"responsible_user_id",render:r=>{if(!r)return t.jsx("div",{style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e==="dark"?"#9ca3af":"#6b7280"},children:s("Not assigned")});const o=st.get(r);if(!o)return t.jsx("div",{style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e==="dark"?"#9ca3af":"#6b7280"},children:s("Loading...")});const a=(o==null?void 0:o.name)||s("Unknown operator");return t.jsx("div",{title:a,style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e==="dark"?"#f3f4f6":"#111827"},children:a})}},{title:s("Status"),dataIndex:"status_id",render:r=>{if(!r)return t.jsx("div",{style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e==="dark"?"#9ca3af":"#6b7280"},children:s("Unknown status")});const o=it.get(r),a=(o==null?void 0:o.name)||s("Unknown status");return t.jsx("div",{style:{maxWidth:"150px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e==="dark"?"#f3f4f6":"#111827"},title:a,children:a})}},{title:s("Actions"),key:"actions",render:(r,o)=>t.jsx(w.button,{style:ft,whileHover:{scale:1.05,backgroundColor:e==="dark"?"#047857":"#d1fae5"},whileTap:{scale:.95},onClick:()=>{P(o),B(!0)},children:t.jsx(St,{style:{width:"18px",height:"18px",color:e==="dark"?"#10b981":"#059669"}})})}];if(rt)return t.jsx("div",{style:K,children:t.jsx("div",{style:{textAlign:"center",padding:"48px",color:e==="dark"?"#ef4444":"#dc2626"},children:t.jsx("p",{style:{fontSize:"18px",fontWeight:"500"},children:"Error loading leads data"})})});const S=r=>{var m;if(!(g!=null&&g.custom_fields_values))return"-";const o=g.custom_fields_values.find(l=>l.find(I=>Array.isArray(I)&&I[0]==="field_name"&&I[1]===r)!==void 0);if(!o)return"-";const a=o.find(l=>Array.isArray(l)&&l[0]==="values");if(!a||!a[1]||!Array.isArray(a[1])||((m=a[1])==null?void 0:m.length)===0)return"-";const c=a[1][0];if(!c||!Array.isArray(c))return"-";const u=c.find(l=>Array.isArray(l)&&l[0]==="value");return u?u[1]:"-"};return t.jsx(yt,{theme:nt(),children:t.jsxs(w.div,{style:K,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[t.jsxs(w.div,{style:dt,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.4,delay:.1},children:[t.jsx("h1",{style:lt,children:s("Leads")}),t.jsx(bt,{})]}),t.jsx(w.div,{style:ct,initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{duration:.4,delay:.2},children:t.jsx(kt,{columns:ut,dataSource:y,rowKey:"id",pagination:{total:at,pageSize:50,current:v,showSizeChanger:!1,onChange:ot,showTotal:(r,o)=>{const a=Math.ceil(o[0]/50),c=Math.ceil(r/50);return`${s("Page")} ${a} ${s("of")} ${c} (${r} ${s("total items")})`}},loading:tt||et})}),t.jsx(wt,{title:t.jsx("span",{style:{color:e==="dark"?"#f3f4f6":"#111827"},children:s("Leads Details")}),open:Z,onCancel:()=>{B(!1),P(null)},footer:null,width:800,styles:{mask:{backgroundColor:e==="dark"?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.45)"},content:{backgroundColor:e==="dark"?"#1f2937":"#ffffff",color:e==="dark"?"#f3f4f6":"#111827"},header:{backgroundColor:e==="dark"?"#1f2937":"#ffffff",borderBottom:`1px solid ${e==="dark"?"#374151":"#f0f0f0"}`,color:e==="dark"?"#f3f4f6":"#000000"},body:{backgroundColor:e==="dark"?"#1f2937":"#ffffff"}},children:t.jsx("div",{style:{padding:"16px",width:"100%"},children:g&&t.jsx(w.table,{style:pt,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3},children:t.jsxs("tbody",{children:[t.jsxs("tr",{children:[t.jsx("th",{style:b,children:s("Ehtimollik foizi")}),t.jsx("td",{style:k,children:S("Ehtimollik foizi")+"%"})]}),t.jsxs("tr",{children:[t.jsx("th",{style:b,children:s("Izoh")}),t.jsx("td",{style:k,children:S("Izoh")})]}),t.jsxs("tr",{children:[t.jsx("th",{style:b,children:s("Summary 1")}),t.jsx("td",{style:k,children:S("Summary-1")})]}),t.jsxs("tr",{children:[t.jsx("th",{style:b,children:s("Summary 2")}),t.jsx("td",{style:k,children:S("Summary-2")})]}),t.jsxs("tr",{children:[t.jsx("th",{style:b,children:s("Summary 3")}),t.jsx("td",{style:k,children:S("Summary-3")})]})]})})})})]})})};export{le as default};
